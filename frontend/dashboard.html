<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Dashboard | Franz Finance</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<script>
  if (localStorage.getItem('logado') !== 'sim') {
    window.location.href = 'index.html';
  }
</script>

<div class="app">
  <header>
    <h1>Dashboard</h1>
  </header>

  <main>

    <div class="card green">
      <span>Lucro do Dia</span>
      <strong>R$ 0,00</strong>
    </div>

    <div class="card red">
      <span>Boletos Pendentes</span>
      <strong>Nenhum</strong>
    </div>

    <button class="primary" onclick="location.href='add.html'">
      Lan√ßar Dia
    </button>

    <button class="primary" onclick="location.href='boletos.html'">
      Cadastrar Boletos
    </button>

    <button class="secondary" onclick="location.href='fechar-caixa.html'">
      Fechar Caixa
    </button>

    <button class="secondary" onclick="logout()">
      Sair
    </button>

  </main>
</div>

<script>
  function logout() {
    localStorage.removeItem('logado');
    window.location.href = 'index.html';
  }

  // Buscar lucro do dia
  fetch('/lucro-dia')
    .then(res => res.json())
    .then(data => {
      const total = data.total ? Number(data.total) : 0;
      document.querySelector('.card.green strong').innerText =
        `R$ ${total.toFixed(2)}`;
    })
    .catch(() => {
      document.querySelector('.card.green strong').innerText = 'R$ 0,00';
    });

  // Buscar boletos pendentes
  fetch('/boletos-pendentes')
    .then(res => res.json())
    .then(data => {
      const texto = data.total > 0
        ? `${data.total} pendente(s)`
        : 'Nenhum';

      document.querySelector('.card.red strong').innerText = texto;
    })
    .catch(() => {
      document.querySelector('.card.red strong').innerText = 'Nenhum';
    });
</script>

</body>
</html>
