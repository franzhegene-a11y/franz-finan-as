<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Lançar Dia | Franz Finance</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<script>
  if (localStorage.getItem('logado') !== 'sim') {
    window.location.href = 'index.html';
  }
</script>

<div class="app">
  <h1>Lançar Dia</h1>

  <input
    type="number"
    id="valor"
    placeholder="Valor do dia"
    step="0.01"
  />

  <button class="primary" onclick="salvar()">
    Salvar
  </button>

  <button class="secondary" onclick="voltar()">
    Voltar
  </button>
</div>

<script>
async function salvar() {
  const valorInput = document.getElementById('valor').value;
  const valor = Number(valorInput);

  if (!valorInput || isNaN(valor) || valor <= 0) {
    alert('Digite um valor válido');
    return;
  }

  try {
    const response = await await fetch("/lancar-dia", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ valor: Number(valor) })
});

    const data = await response.json();

    if (!response.ok) {
      alert(data.erro || 'Erro desconhecido do servidor');
      return;
    }

    alert('Lançamento salvo com sucesso!');
    window.location.href = '/dashboard.html';

  } catch (err) {
    console.error(err);
    alert('Erro de conexão com o servidor');
  }
}

function voltar() {
  window.location.href = '/dashboard.html';
}
</script>

</body>
</html>
