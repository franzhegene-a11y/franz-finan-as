<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Lançar Dia | Franz Finance</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<script>
  if (localStorage.getItem('logado') !== 'sim') {
    window.location.href = 'index.html';
  }
</script>

<div class="app">
  <h1>Lançar Dia</h1>

  <input
    type="number"
    id="valor"
    placeholder="Valor do dia"
    step="0.01"
  />

  <button class="primary" onclick="salvar()">
    Salvar
  </button>

  <button class="secondary" onclick="voltar()">
    Voltar
  </button>
</div>

<script>
  function salvar() {
    const valor = Number(document.getElementById('valor').value);

    if (!valor || valor <= 0) {
      alert('Informe um valor válido');
      return;
    }

    fetch('/lancar-dia', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ valor })
    })
    .then(async res => {
      const data = await res.json();

      if (!res.ok) {
        throw new Error(data.error || 'Erro desconhecido');
      }

      alert(`Dia lançado: R$ ${valor.toFixed(2)}`);
      window.location.href = 'dashboard.html';
    })
    .catch(err => {
      alert('Erro real: ' + err.message);
    });
  }

  function voltar() {
    window.location.href = 'dashboard.html';
  }
</script>

</body>
</html>
